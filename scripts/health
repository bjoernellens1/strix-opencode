#!/usr/bin/env bash
set -uo pipefail

if [[ -f .env ]]; then
  set -a
  source .env
  set +a
fi

function check() {
  local port="$1"
  local label="$2"
  echo "== ${label} :${port} =="
  if response=$(curl -sf --connect-timeout 3 --max-time 5 "http://127.0.0.1:${port}/v1/models" 2>&1); then
    echo "$response" | head -c 400
  else
    echo "(not responding)"
  fi
  echo ""
}

check "${THOR_PORT:-8001}" "Thor âš¡ Primary Commander (vLLM)"
check "${VALKYRIE_PORT:-8002}" "Valkyrie ğŸ›¡ Execution Specialist (vLLM)"
check "${ODIN_PORT:-8011}" "Odin ğŸ‘ï¸ Supreme Architect (llama.cpp)"
check "${HEIMDALL_PORT:-8012}" "Heimdall ğŸ‘ Guardian (llama.cpp)"
check "${LOKI_PORT:-8013}" "Loki ğŸ§  Adversarial Intelligence (llama.cpp)"
check "${FRIGGA_PORT:-8014}" "Frigga ğŸŒ¿ Knowledge Curator (llama.cpp)"
