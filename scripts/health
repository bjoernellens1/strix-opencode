#!/usr/bin/env bash
set -uo pipefail

if [[ -f .env ]]; then
  set -a
  source .env
  set +a
fi

function check() {
  local port="$1"
  local label="$2"
  echo "== ${label} :${port} =="
  if response=$(curl -sf --connect-timeout 3 --max-time 5 "http://127.0.0.1:${port}/v1/models" 2>&1); then
    echo "$response" | head -c 400
  else
    echo "(not responding)"
  fi
  echo ""
}

check "${OLLAMA_PORT:-11434}" "Ollama (OpenAI-compatible)"
