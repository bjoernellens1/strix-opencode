#!/usr/bin/env bash
set -euo pipefail

TARGET="${1:-vllm}"

FILE="opencode/opencode.jsonc"

case "$TARGET" in
  vllm)
    sed -i 's/"primary":[^}]*}/"primary": { "mode": "primary", "model": "local_orch:orch" }/g' "$FILE"
    ;;
  cloud)
    sed -i 's/"primary":[^}]*}/"primary": { "mode": "primary", "model": "cloud_planner:planner" }/g' "$FILE"
    ;;
  *)
    echo "Usage: $0 {vllm|cloud}"
    exit 1
    ;;
esac

echo "Switched primary agent to: $TARGET"
